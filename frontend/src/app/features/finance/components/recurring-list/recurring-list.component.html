<div class="space-y-6">
  <div class="flex items-center justify-between">
    <h1 class="text-3xl font-bold text-neutral-900">Recurring Invoices</h1>
    <app-button variant="primary">New Recurring</app-button>
  </div>

  @if (recurringState$ | async; as state) {
    @if (state.loading) {
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        @for (item of [1,2,3]; track $index) {
          <app-card [isLoading]="true" />
        }
      </div>
    }

    @if (!state.loading && state.items.length === 0) {
      <app-empty-state
        icon="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"
        title="No recurring invoices"
        description="Set up recurring invoices for repeat billing."
        actionLabel="New Recurring"
      />
    }

    @if (!state.loading && state.items.length > 0) {
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        @for (item of state.items; track item.id) {
          <app-card [title]="item.description" [subtitle]="item.frequency + ' Â· ' + (item.amount | currency:item.currency:'symbol':'1.2-2')">
            <div class="space-y-2 text-sm">
              <div class="flex justify-between">
                <span class="text-neutral-500">Status</span>
                <span [class.text-green-600]="item.isActive" [class.text-neutral-500]="!item.isActive">
                  {{ item.isActive ? 'Active' : 'Inactive' }}
                </span>
              </div>
              <p class="text-neutral-500">Next: {{ formatDate(item.nextGenerationDate) }}</p>
            </div>
          </app-card>
        }
      </div>

      @if (state.hasMore) {
        <div
          appInfiniteScroll
          (appInfiniteScrollLoad)="loadMore()"
          class="flex flex-col items-center justify-center py-8 gap-3"
        >
          @if (state.loadingMore) {
            <span class="text-sm text-neutral-500">Loading more...</span>
          } @else {
            <button type="button" (click)="loadMore()" class="text-sm font-medium text-primary-600 hover:text-primary-700">Load more</button>
          }
        </div>
      }
    }
  }
</div>
